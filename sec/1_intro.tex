\section{Introduction}
\label{sec:intro}

The successful implementation of percutaneous coronary intervention (PCI) is highly dependent on real-time, high-precision intraoperative vascular segmentation results [YTL]. However, this medical demand faces many challenges. First, from the perspective of clinical application, vascular segmentation needs to meet submillimeter geometric accuracy; second, from the perspective of technical implementation, existing methods are severely limited by the feasibility of manual annotation - the annotation of a single coronary angiography image takes 30-45 minutes, and requires the annotator to have a dual knowledge background in cardiovascular anatomy and radiological imaging physics. The vascular system has a complex tree-like topological structure, a large number of easily overlooked terminal microvessels, and a geometric shape with drastic changes in curvature, so the manpower cost of annotation work is huge. In addition, differences in contrast agent concentrations can cause nonlinear fluctuations in vascular imaging intensity, which further exacerbates the challenge of coronary artery segmentation.

%-------------------------------------------------------------------------

Traditional vascular segmentation methods [FC.13.YNet][FC.22.Hessian] rely heavily on manually designed features and complex parameter optimization, which results in limited model generalization ability and difficulty in adapting to vascular morphological variations under different imaging protocols. In recent years, supervised methods based on deep learning [SSVS.8][SSVS.33][SSVS.36] have made breakthroughs in accuracy, but they rely on a large number of accurately labeled vascular masks. Domain adaptive methods [SSVS.3] [SSVS.31][01.00.C-DARL] Although the target data domain does not require annotation, it must be labeled in the source data, and the annotation cost of some domain adaptive methods [00.01.XA-Sim2Real] in the source data is higher than that in the target data domain. In order to alleviate the annotation burden, researchers have tried to adopt unsupervised segmentation [FC.19.IIC][FC.9.ReDO] strategies, but due to the complex characteristics of vascular structure, unsupervised segmentation is poor in key segmentation indicators. In contrast, 
self-supervised learning extracts anatomical semantic features from unlabeled data by constructing pre-training tasks \cite{01.02.SSVS}[01.01.DARL][02.01.FreeCOS], 
while reducing the reliance on annotations and still being able to achieve high accuracy in complex vascular segmentation tasks. 
This provides a new approach for developing PCI assistance systems that balance accuracy and practicality.

%-------------------------------------------------------------------------

In the process of investigating image segmentation methods, we found that some methods [FC.19.IIC][FC.9.ReDO] performed well in natural scenes, but performed poorly when directly transferred to the coronary artery segmentation task. This is essentially due to the fundamental difference in the physical imaging mechanism between medical images and photographic images. In terms of projection geometry, natural images follow the perspective projection law (larger near and smaller far), while X-ray angiography uses orthogonal projection, which causes the spatial correlation of blood vessel diameters to disappear. In terms of lighting conditions, photographic scenes rely on multi-source ambient light, while medical imaging uses a directional X-ray beam with a fixed energy spectrum, which eliminates shadow interference but exacerbates the low contrast problem. More importantly, in terms of differences in light propagation modes, natural images mainly record the reflected light on the surface of objects [web3d][web3d.2], while X-ray imaging relies on penetrating radiation (Beer-Lambert law), which makes the blood vessel boundary present a unique gradient attenuation feature. These physical differences make it difficult for traditional segmentation models to capture the topological constraints of coronary arteries (such as branch continuity). To this end, this paper innovatively constructs a segmentation framework that conforms to human anatomy based on the physical principles of X-ray fluoroscopy, thereby greatly improving the effect of coronary artery segmentation.

%-------------------------------------------------------------------------

This paper proposes a self-supervised vascular segmentation framework based on physical imaging mechanism. Specifically: 
\begin{quotation}
  \noindent
First, this paper designs a new background image synthesis algorithm, which removes blood vessels in the angiogram through Fourier processing with double elliptical ring band constraints to obtain a synthetic background image. This paper also proves the superiority of double elliptical ring band constraints in the background image synthesis process; 

Then, this method integrates three-dimensional perspective projection into the vascular synthesis process of the self-supervised segmentation algorithm for the first time, regulates the contrast agent concentration through the Beer-Lambert law [Beer-Lambert], and uses L-systems [02.02.L-systems] to generate a tree-like vascular structure that conforms to anatomical characteristics; 

Finally, this paper uses a knowledge transfer mechanism based on contrast learning, adversarial learning, and consistency regularization to transfer the knowledge learned from the synthetic data to the real data set. 
\end{quotation}
%-------------------------------------------------------------------------

Experimental results show that our method has achieved significant breakthroughs in the coronary artery segmentation task. 
On the public dataset XCAD, our method surpasses the best existing self-supervised scheme in key indicators (Jaccard=0.597 vs. 0.499). 
On the DSA\_Tongji dataset collected by our university, our method even surpasses some supervised methods (Jaccard=0.547 vs. 0.4091). The contribution of this paper can be summarized as follows: (a) The first application of synthetic data imaged through 3D perspective technology in the XCA self supervised segmentation framework; (b) A new spectral image segmentation method (double ellipse constraint) has been designed based on the characteristics of XCA images; (c) A new data perturbation method based on adjusting contrast agent concentration has been designed. And the data perturbation method was applied to the consistency regularization loss function.

